---
version: "3"

tasks:
  install:
    cmds:
      - task: apt
      - task: yum
    status:
      - which direnv
  apt:
    ignore_error: true
    cmds:
      - >-
        which apt &&
        sudo apt install -qq -o=Dpkg::Use-Pty=0 -y direnv
  yum:
    ignore_error: true
    cmds:
      - >-
        which yum &&
        curl -sfL https://direnv.net/install.sh | sudo bash
  setup:
    deps:
      - install
    cmds:
      - >-
        grep -qF 'eval "$(direnv hook bash)"' ~/.bashrc ||
        echo 'eval "$(direnv hook bash)"' >> ~/.bashrc
