version: "3.8"

services:
  varken:
    image: boerderij/varken:latest
    depends_on:
      - influxdb
    secrets:
      - source: varken_ini
        target: /config/varken.ini
    volumes:
      - /mnt/varken:/config
    environment:
      - TZ=America/Los_Angeles
    networks:
      - monitoring
    deploy:
      restart_policy:
        condition: on-failure

networks:
  monitoring:
    attachable: true

secrets:
  varken_ini:
    file: ./secrets/varken.ini
