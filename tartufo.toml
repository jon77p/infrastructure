[tool.tartufo]
json = false
cleanup = true
regex = true
entropy = true

exclude-path-patterns = [
  {path-pattern = '\.talismanrc', reason = 'Talisman config file'},
  {path-pattern = 'package-lock\.json', reason = 'NPM Lock File'},
  {path-pattern = '(.*/)?go\.sum$', reason = 'Go Module Sum File'},
  {path-pattern = '.*\.sops\.yaml$', reason = 'SOPS files'},
  {path-pattern = 'terraform/.*\.terraform\.lock\.hcl$', reason = 'Terraform Lock HCL File'},
]

exclude-signatures = [
  {signature = 'b1434d58d5848f2534a345b8fb22ffb652a9647321e06093090a785bb5128f1b', reason = 'code-server legacy submodule'},
  {signature = '373429020f64fb6cb709012a146919d9e01e631cf39bae1e8735a6795abdcc6a', reason = 'code-server legacy submodule'},
  {signature = '0b826d8b88855f5a4f302aa9fe34fa18ed0469c2e2dd0acb606253b2668c1953', reason = 'pihole virtual host variable name'},
  {signature = 'c78f82d58da79c52fe5ab02a27bbfe82e316bafac7514fb7f9eb6da255106add', reason = 'example Grafana auth pattern for database in template file'},
]

exclude-entropy-patterns = [
  {path-pattern = '\.github/workflows/.*\.ya?ml$', pattern = '@[a-zA-Z0-9]{40}', reason = 'GitHub Actions'},
  {path-pattern = 'package\.json$', pattern = '"gitHead": "[0-9a-f]{40}"', reason = 'git SHAs in package.json (generated by npm publish)'},
  {path-pattern = 'yarn\.lock$', pattern = '"gitHead": "[0-9a-f]{40}"', reason = 'git SHAs in yarn.lock (generated by yarn build)'},
  {path-pattern = '(.+/)?docker-compose\.ya?ml', pattern = 'image: .+@sha256:[a-zA-Z0-9]{40}', reason = 'SHAs in image references'},
  {path-pattern = 'README.md', pattern = 'https://healthchecks.(thepi.cloud|jon77p.xyz)/badge/.+/.+[.]svg', reason = 'Healthchecks Badges'},
  {path-pattern = 'docs/', pattern = 'https://(avatars|raw).githubusercontent.com/.+(.png|.svg)', reason = 'Github-hosted links to images'},
]
