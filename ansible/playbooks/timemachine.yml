---
- hosts: localhost,timemachine
  vars:
    opconnect_items:
      timemachine:
        - "healthcheck"
        - "username"
        - "password"
        - "sharename"
      crowdsec:
        - "key"
  roles:
    - 1password

- hosts: timemachine
  become: true
  roles:
    - common
    - cloudflared
    - cloudflare
    - crowdsec
    - iptables
    - innernet
    - dns
    - stefangweichinger.ansible_rclone
    - rclone
    - node_exporter
    - promtail
    - docker

- name: Setup OCI for timemachine
  hosts: localhost
  vars:
    oci_hostname: timemachine
    hostname: "{{ oci_hostname }}"
  roles:
    - oci
