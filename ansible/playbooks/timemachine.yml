---
- hosts: localhost,timemachine
  vars:
    opconnect_item_names:
      - "timemachine"
    opconnect_field_names:
      - "healthcheck"
      - "username"
      - "password"
      - "sharename"
  roles:
    - 1password

- name: Setup timemachine
  hosts: timemachine
  become: true
  roles:
    - common
    - cloudflared
    - cloudflare
#     - innernet
#     - dns
    - stefangweichinger.ansible_rclone
    - rclone
#     - promtail
    - docker
    - iptables

- name: Setup OCI for timemachine
  hosts: localhost
  vars:
    oci_hostname: timemachine
    hostname: "{{ oci_hostname }}"
  roles:
    - oci
