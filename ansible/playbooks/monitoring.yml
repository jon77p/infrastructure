---
- name: Get 1Password secrets
  hosts: localhost,monitoring
  vars:
    opconnect_items:
      grafana:
        - username
        - password
        - smtp_username
        - smtp_password
        - cloud_tenant_name
        - cloud_admin_token
        - cloud_service_account_token
      influxdb:
        - username
        - password
      mediaserver:
        - tautulli_url
        - tautulli_apikey
        - sonarr_url
        - sonarr_apikey
        - radarr_url
        - radarr_apikey
        - lidarr_url
        - lidarr_apikey
        - ombi_url
        - ombi_apikey
        - maxmind_license_key
      healthchecks:
        - apikey
  roles:
    - opconnect

- name: Setup monitoring
  hosts: monitoring
  become: true
  roles:
    - common
    - cloudflared
    - cloudflare
    - iptables
    - dns
    - healthchecks
    - cron
    - grafana_agent
    - grafana
    - varken
    - docker
