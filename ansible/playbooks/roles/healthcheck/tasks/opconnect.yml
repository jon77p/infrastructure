---
- name: Find item
  environment:
    OP_CONNECT_HOST: "{{ hostvars['localhost'].op_connect_host }}"
    OP_CONNECT_TOKEN: "{{ hostvars['localhost'].op_connect_token }}"
  onepassword.connect.field_info:
    item: "{{ hostname }}"
    field: healthcheck
    vault: "{{ hostvars['localhost'].op_connect_vault_id }}"
  register: healthcheck

- debug:
    msg: "{{ healthcheck.field.value }}"

- name: "Update hostname healthcheck"
  set_fact:
    healthcheck_uuids: "{{ healthcheck_uuids | combine(new_healthcheck) }}"
  vars:
    new_healthcheck: '{ "{{ hostname }}": "{{ healthcheck.field.value }}" }'
