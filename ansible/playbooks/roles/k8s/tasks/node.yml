---
- include_vars: node.yml

- name: Check if k3s is installed
  become: true
  stat:
    path: /usr/local/bin/k3s
  register: k3s_check

# - name: Include innernet variables
# when: not k3s_check.stat.exists
# include_vars: roles/innernet/vars/main.yml

- name: Install k3s
  when: not k3s_check.stat.exists
  become: true
  # shell: curl -sfL https://get.k3s.io | K3S_URL=https://{{ manager }}.{{ innernet_network }}.wg:6443 K3S_TOKEN={{ k3s_token }} sh
  shell: curl -sfL https://get.k3s.io | K3S_URL=https://{{ manager }}:6443 K3S_TOKEN={{ k3s_token }} sh
