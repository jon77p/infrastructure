---
- name: Get 1Password secrets
  hosts: localhost,nextcloud
  vars:
    opconnect_items:
      nextcloud:
        - "healthcheck"
        - "username"
        - "password"
        - "smtp_username"
        - "smtp_password"
        - "mysql_username"
        - "mysql_password"
      crowdsec:
        - "key"
  roles:
    - opconnect

- name: Setup nextcloud
  hosts: nextcloud
  become: true
  roles:
    # - common
    # - cloudflared
    # - cloudflare
    # - crowdsec
    # - iptables
    # - innernet
    # - dns
    - node_exporter
    # - stefangweichinger.ansible_rclone
    # - rclone
    - nextcloud
    - promtail
    - docker
