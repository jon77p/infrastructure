---
- name: Get 1Password secrets
  hosts: localhost,healthchecks
  vars:
    opconnect_items:
      healthchecks:
        - healthcheck
        - username
        - password
        - smtp_username
        - smtp_password
        - project_id
        - readonly_apikey
  roles:
    - opconnect

- name: Setup healthchecks
  hosts: healthchecks
  become: true
  roles:
    - common
    - cloudflared
    - cloudflare
    - iptables
    - dns
    - grafana_agent
    - docker
